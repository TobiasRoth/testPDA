<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Data analysis step by step | Data Analysis in Ecology with R and Stan</title>
  <meta name="description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Data analysis step by step | Data Analysis in Ecology with R and Stan" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.jpg" />
  <meta property="og:description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="github-repo" content="TobiasRoth/BDAEcology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Data analysis step by step | Data Analysis in Ecology with R and Stan" />
  
  <meta name="twitter:description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="twitter:image" content="images/cover.jpg" />

<meta name="author" content="FrÃ¤nzi Korner-Nievergelt and Tobias Roth" />


<meta name="date" content="2019-09-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="settings/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="analyses-steps.html"><a href="analyses-steps.html"><i class="fa fa-check"></i><b>1</b> Data analysis step by step</a><ul>
<li class="chapter" data-level="1.1" data-path="analyses-steps.html"><a href="analyses-steps.html#step1"><i class="fa fa-check"></i><b>1.1</b> Plausibility of Data</a></li>
<li class="chapter" data-level="1.2" data-path="analyses-steps.html"><a href="analyses-steps.html#step2"><i class="fa fa-check"></i><b>1.2</b> Relationships</a></li>
<li class="chapter" data-level="1.3" data-path="analyses-steps.html"><a href="analyses-steps.html#step3"><i class="fa fa-check"></i><b>1.3</b> Data Distribution</a></li>
<li class="chapter" data-level="1.4" data-path="analyses-steps.html"><a href="analyses-steps.html#step4"><i class="fa fa-check"></i><b>1.4</b> Preparation of Explanatory Variables</a></li>
<li class="chapter" data-level="1.5" data-path="analyses-steps.html"><a href="analyses-steps.html#step5"><i class="fa fa-check"></i><b>1.5</b> Data Structure</a></li>
<li class="chapter" data-level="1.6" data-path="analyses-steps.html"><a href="analyses-steps.html#step6"><i class="fa fa-check"></i><b>1.6</b> Define Prior Distributions</a></li>
<li class="chapter" data-level="1.7" data-path="analyses-steps.html"><a href="analyses-steps.html#step7"><i class="fa fa-check"></i><b>1.7</b> Fit the Model</a></li>
<li class="chapter" data-level="1.8" data-path="analyses-steps.html"><a href="analyses-steps.html#step8"><i class="fa fa-check"></i><b>1.8</b> Check Model</a></li>
<li class="chapter" data-level="1.9" data-path="analyses-steps.html"><a href="analyses-steps.html#step9"><i class="fa fa-check"></i><b>1.9</b> Model Uncertainty</a></li>
<li class="chapter" data-level="1.10" data-path="analyses-steps.html"><a href="analyses-steps.html#step10"><i class="fa fa-check"></i><b>1.10</b> Draw Conclusions</a></li>
<li class="chapter" data-level="" data-path="analyses-steps.html"><a href="analyses-steps.html#further-reading"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="divider"></li>
</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in Ecology with R and Stan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyses_steps" class="section level1">
<h1><span class="header-section-number">1</span> Data analysis step by step</h1>
<p>In this chapter we provide a checklist with some guidance for data analysis. However, do not expect the list to be complete and for different studies, a different order of the steps may make more sense. We usually repeat steps <a href="analyses-steps.html#step2">1.2</a> to <a href="analyses-steps.html#step8">1.8</a> until we find a model that fit the data well and that is realistic enough to be useful for the intended purpose. Data analysis is always a lot of work and, often, the following steps have to be repeated many times until we find a useful model.</p>
<p>There is a chance and danger at the same time: we may find interesting results that answer different questions than we asked originally. They may be very exciting and important, however they may be biased. We can report such findings, but we should state that they appeared (more or less by chance) during the data exploration and model fitting phase, and we have to be aware that the estimates may be biased because the study was not optimally designed with respect to these findings. It is important to always keep the original aim of the study in mind. Do not adjust the study question according to the data. We also recommend reporting what the model started with at the first iteration and describing the strategy and reasoning behind the model development process.</p>
<div id="step1" class="section level2">
<h2><span class="header-section-number">1.1</span> Plausibility of Data</h2>
<p>Prepare the data and check graphically, or via summary statistics, whether all the data are plausible. Prepare the data so that errors (typos, etc.) are minimal, for example, by double-checking the entries. See chapter <a href="#datamanip"><strong>??</strong></a> for useful R-code that can be used for data preparation and to make plausibility controls.</p>
</div>
<div id="step2" class="section level2">
<h2><span class="header-section-number">1.2</span> Relationships</h2>
<p>Think about the direct and indirect relationships among the variables of the study. We normally start a data analysis by drawing a sketch of the model including all explanatory variables and interactions that may be biologically meaningful. We will most likely repeat this step after having looked at the model fit. To make the data analysis transparent we should report every model that was considered. A short note about why a specific model was considered and why it was discarded helps make the modeling process reproducible.</p>
</div>
<div id="step3" class="section level2">
<h2><span class="header-section-number">1.3</span> Data Distribution</h2>
<p>What is the nature of the variable of interest (outcome, dependent variable)? At this stage, there is no use of formally comparing the distribution of the outcome variable to a statistical distribution, because the rawdata is not required to follow a specific distribution. The models assume that conditional on the explanatory variables and the model structure, the outcome variable follows a specific distribution. Therefore, checking how well the chosen distribution fits to the data is done after the model fit <a href="analyses-steps.html#step8">1.8</a>. This first choice is solely done based on the nature of the data. Normally, our first choice is one of the classical distributions for which robust software for model fitting is available.</p>
<p>Here is a rough guideline for this first choice:</p>
<blockquote>
<p>continuous measurements <span class="math inline">\(\Longrightarrow\)</span> normal distribution<br />
&gt; exceptions: time-to-event data <span class="math inline">\(\Longrightarrow\)</span> see survival analysis</p>
</blockquote>
<blockquote>
<p>count <span class="math inline">\(\Longrightarrow\)</span> Poisson or negative-binomial distribution</p>
</blockquote>
<blockquote>
<p>count with upper bound (proportion) <span class="math inline">\(\Longrightarrow\)</span> binomial distribution</p>
</blockquote>
<blockquote>
<p>binary <span class="math inline">\(\Longrightarrow\)</span> Bernoully distribution</p>
</blockquote>
<blockquote>
<p>rate (count by a reference) <span class="math inline">\(\Longrightarrow\)</span> Poisson including an offset</p>
</blockquote>
<blockquote>
<p>nominal <span class="math inline">\(\Longrightarrow\)</span> multinomial distribution</p>
</blockquote>
<p>Chapter <a href="#distributions"><strong>??</strong></a> gives an overview of the distributions that are most relevant for ecologists.</p>
</div>
<div id="step4" class="section level2">
<h2><span class="header-section-number">1.4</span> Preparation of Explanatory Variables</h2>
<ol style="list-style-type: decimal">
<li>Look at the distribution (histogram) of every explanatory variable: Linear models do not assume that the explanatory variables have any specific distribution. Thus there is no need to check for a normal distribution! However, very skewed distributions result in unequal weighting of the observations in the model. In extreme cases, the slope of a regression line is defined by one or a few observations only. We also need to check whether the variance is large enough, and to think about the shape of the expected effect. The following four questions may help with this step:</li>
</ol>
<ol style="list-style-type: decimal">
<li><p>Is the variance (of the explanatory variable) big enough so that an effect of the variable can be measured?</p></li>
<li><p>Is the distribution skewed? If an explanatory variable is highly skewed, it may make sense to transform the variable (e.g., log, square-root).</p></li>
<li><p>Does it show a bimodal distribution? Consider making the variable binary.</p></li>
<li><p>Is it expected that a change of 1 at lower values for x has the same biological effect as a change of 1 at higher values of x? If not, a trans- formation (e.g., log) could linearize the relationship between x and y.</p></li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li><p>Centering: Centering (<span class="math inline">\(x.c = x-mean(x)\)</span>) is a transformation that produces a variable with a mean of 0. Centering is optional. We have two reasons to center a predictor variable. First, it helps the model fitting algorithm to better converge because it reduces correlations among model parameters. Second, with centered predictors, the intercept and main effects in the linear model are better interpretable (they are measured at the center of the data instead of at the covariate value of 0 which may be far off).</p></li>
<li><p>Scaling: Scaling (<span class="math inline">\(x.s = x/c\)</span>, where <span class="math inline">\(c\)</span> is a constant) is a transformation that changes the unit of the variable. Also scaling is optional. We have three reasons to scale an predictor variable. First, to make the effect sizes better understandable. For example, a population change from one year to the next may be very small and hard to interpret. When we give the change for a 10-year period, its ecological meaning is better understandable. Second, to make the estimate of the effect sizes comparable between variables, we may use <span class="math inline">\(x.s = x/sd(x)\)</span>. The resulting variable has a unit of one standard deviation. A standard deviation may be comparable between variables that oritinally are measured in different units (meters, seconds etc). <span class="citation">Gelman and Hill (<a href="#ref-Gelman2007" role="doc-biblioref">2007</a>)</span> (p.Â 55 f) propose to scale the variables by two times the standard deviation (<span class="math inline">\(x.s = x/(2*sd(x))\)</span>) to make effect sizes comparable between numeric and binary variables. Third, scaling can be important for model convergence, especially when polynomials are included. Also, consider the use of orthogonal polynomials, see Chapter 4.2.9 in <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span>.</p></li>
<li><p>Collinearity: Look at the correlation among the explanatory variables (pairs plot or correlation matrix). If the explanatory variables are correlated, go back to step 2. Also, Chapter 4.2.7 in <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span> discusses collinearity.</p></li>
<li><p>Are interactions and polynomial terms needed in the model? If not already
done in step 2, think about the relationship between each explanatory variable and the dependent variable. Is it linear or do polynomial terms have to be included in the model? If the relationship cannot be described appropriately by polynomial terms, think of a nonlinear model or a generalized additive model (GAM). May the effect of one explanatory variable depend on the value of
another explanatory variable (interaction)?</p></li>
</ol>
</div>
<div id="step5" class="section level2">
<h2><span class="header-section-number">1.5</span> Data Structure</h2>
<p>After having taken into account all of the (fixed effect) terms from step 4: are the observations independent or grouped/structured? What random factors are needed in the model? Are the data obviously temporally or spatially correlated? Or, are other correlation structures present, such as phylogenetic relationships?
Our strategy is to start with a rather simple model that may not account for all correlation structures that in fact are present in the data. We first, only include those that are known to be important a priory. Only when residual analyses reveals important additional correlation structures, we include them in the model.</p>
</div>
<div id="step6" class="section level2">
<h2><span class="header-section-number">1.6</span> Define Prior Distributions</h2>
<p>Decide whether we would like to use informative prior distributions or whether we would like use priors that only have a negligible effect on the results. When the results are later used for informing authorities or for making a decision (as usual in applied sciences), then we would like to base the results on all information available. Information from the literature is then used to construct informative prior distributions. In contrast to applied sciences, in basic research we often would like to show only the information in the data that should not be influenced by earlier results. Therefore, in basic research we look for priors that do not influence the results.</p>
</div>
<div id="step7" class="section level2">
<h2><span class="header-section-number">1.7</span> Fit the Model</h2>
<p>Fit the model.</p>
</div>
<div id="step8" class="section level2">
<h2><span class="header-section-number">1.8</span> Check Model</h2>
<p>We assess model fit by graphical analyses of the residuals (Chapter 6 in <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span>), by predictive model checking (Section 10.1 in <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span>), or by sensitivity analysis (Chapter 15 in <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span>).</p>
<p>For non-Gaussian models it is often easier to assess model fit using pos- terior predictive checks (Chapter 10 in <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span>) rather than residual analyses. Posterior predictive checks usually show clearly in which aspect the model failed so we can go back to step 2 of the analysis. Recognizing in what aspect a model does not fit the data based on residual plots improves with experience. Therefore, we list in Chapter 16 of <span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span> some patterns that can appear in residual plots together with what these patterns possibly indicate. We also indicate what could be done in the specific cases.</p>
</div>
<div id="step9" class="section level2">
<h2><span class="header-section-number">1.9</span> Model Uncertainty</h2>
<p>If, while working through steps 1 to 8, possibly repeatedly, we came up with one or more models that fit the data reasonably well, we then turn to the methods presented in Chapter 11 (<span class="citation">Korner-Nievergelt et al. (<a href="#ref-KornerNievergelt2015" role="doc-biblioref">2015</a>)</span>) to draw inference from more than one model. If we have only one model, we proceed to <a href="analyses-steps.html#step10">1.10</a>.</p>
</div>
<div id="step10" class="section level2">
<h2><span class="header-section-number">1.10</span> Draw Conclusions</h2>
<p>Simulate values from the joint posterior distribution of the model parameters (sim or Stan). Use these samples to present parameter uncertainty, to obtain posterior distributions for predictions, probabilities of specific hypotheses, and derived quantities.</p>
</div>
<div id="further-reading" class="section level2 unnumbered">
<h2>Further reading</h2>
<ul>
<li><a href="http://r4ds.had.co.nz">R for Data Science by Garrett Grolemund and Hadley Wickham</a>: Introduces the tidyverse framwork. It explains how to get data into R, get it into the most useful structure, transform it, visualise it and model it.</li>
</ul>

<div id="refs" class="references">
<div>
<p>Gelman, A, and J Hill. 2007. <em>Data Analysis Using Regression and Multilevel / Hierarchical Models</em>. Cambridge: Cambridge Universtiy Press.</p>
</div>
<div>
<p>Harju, S. 2016. âBook review:~Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and Stan.â <em>The Journal of Wildlife Management</em> 80: 771.</p>
</div>
<div>
<p>Korner-Nievergelt, F, T Roth, Stefanie von Felten, J GuÃ©lat, B Almasi, and P Korner-Nievergelt. 2015. <em>Bayesian Data Analysis in Ecolog Using Linear Models with R, BUGS, and Stan</em>. New York: Elsevier.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Gelman2007">
<p>Gelman, A, and J Hill. 2007. <em>Data Analysis Using Regression and Multilevel / Hierarchical Models</em>. Cambridge: Cambridge Universtiy Press.</p>
</div>
<div id="ref-KornerNievergelt2015">
<p>Korner-Nievergelt, F, T Roth, Stefanie von Felten, J GuÃ©lat, B Almasi, and P Korner-Nievergelt. 2015. <em>Bayesian Data Analysis in Ecolog Using Linear Models with R, BUGS, and Stan</em>. New York: Elsevier.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TobiasRoth/testBDA/edit/master/03-analyses_steps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["BDAEcology.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
